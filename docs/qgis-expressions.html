<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Ujaval Gandhi" />


<title>QGIS Expressions Masterclass (Workshop Material)</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PDGF11RK4Z"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PDGF11RK4Z');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Courses</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="http://spatialthoughts.com">Back to Main Site</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="#">Back to Top</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">QGIS Expressions Masterclass (Workshop
Material)</h1>
<h3 class="subtitle">Learn QGIS expressions from the ground up.</h3>
<h4 class="author">Ujaval Gandhi</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#software" id="toc-software">Software</a></li>
<li><a href="#get-the-data-package" id="toc-get-the-data-package">Get
the Data Package</a></li>
<li><a href="#expressions-basics" id="toc-expressions-basics">1.
Expressions Basics</a>
<ul>
<li><a href="#expression-operators" id="toc-expression-operators">1.1
Expression Operators</a></li>
<li><a href="#expression-functions" id="toc-expression-functions">1.2
Expression Functions</a></li>
</ul></li>
<li><a href="#advanced-expressions" id="toc-advanced-expressions">2.
Advanced Expressions</a>
<ul>
<li><a href="#geometry-generators" id="toc-geometry-generators">2.1
Geometry Generators</a></li>
<li><a href="#iterations" id="toc-iterations">2.2 Iterations</a></li>
</ul></li>
<li><a href="#data-credits" id="toc-data-credits">Data Credits</a></li>
<li><a href="#license" id="toc-license">License</a></li>
</ul>
</div>

<div style="page-break-after: always;"></div>
<hr />
<p><img src="images/spatial_thoughts_logo.png" width="250pt" style="display: block; margin: auto;" /></p>
<hr />
<div style="page-break-after: always;"></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Expressions are one of the most powerful features of QGIS. In this
hands-on workshop, we will start from the basics of expression syntax
and you will learn how to solve complex problems by combining the basic
building blocks.</p>
<p>This workshop requires basic working knowledge of QGIS.</p>
<p><a
href="https://docs.google.com/presentation/d/16CiiFs3mLyQIrDXf4Uc50DFwRHsmCeMRpo1i25JNk-s/edit?usp=sharing"
target="_blank"><img src="images/qgis_expressions/introduction.png"
width="400" alt="View Presentation" /></a></p>
<p><a
href="https://docs.google.com/presentation/d/1Gv4jZpgMdGR4cvtQxCdf-509CRXNrxuDFW0IXmAug3k/edit?usp=sharing"
target="_blank">View the Presentation ↗</a></p>
</div>
<div id="software" class="section level1">
<h1>Software</h1>
<p>This workshop requires QGIS LTR version 3.40.</p>
<p>Please review <a href="install-qgis-ltr.html">QGIS-LTR Installation
Guide</a> for step-by-step instructions.</p>
</div>
<div id="get-the-data-package" class="section level1">
<h1>Get the Data Package</h1>
<p>The code examples in this workshop use a variety of datasets. All the
required layers, project files etc. are supplied to you in the zip file
<code>qgis-expressions.zip</code>. Unzip this file to the
<code>Downloads</code> directory.</p>
<p>The data package also comes with a <code>solutions</code> folder that
contain model solutions for each section.</p>
<p>Download [qgis-expressions.zip]</p>
</div>
<div id="expressions-basics" class="section level1">
<h1>1. Expressions Basics</h1>
<div id="expression-operators" class="section level2">
<h2>1.1 Expression Operators</h2>
<ol style="list-style-type: decimal">
<li>Open QGIS. Navigate to the folder containing the data package.
Locate and open the <strong>Power_Plants</strong> project. This project
contains 2 data layers. A point layer named <code>power_plants</code>
containing locations of all power plants in the world and a polygon
layer named <code>admin1</code> with states/province boundaries for all
countries.</li>
</ol>
<p><img src="images/qgis_expressions/operator1.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Select the <code>power_plants</code> layer and click <em>Open
Attribute Table</em> button. You will see that the layer as a column
named <code>primary_fuel</code> describing the primary energy source
used in electricity generation. We can use this to select different
types of power plants.</li>
</ol>
<p><img src="images/qgis_expressions/operator2.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>We will now use an expressions to select features from this layer.
From the <em>Selection Toolbar</em>, click the <em>Select Features by
Expression…</em> button.</li>
</ol>
<p><img src="images/qgis_expressions/operator3.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="4" style="list-style-type: decimal">
<li>In the <em>Expression</em> dialog, locate the
<strong>primary_fuel</strong> attribute under <em>Fields and Values</em>
group. Double-click to add it to the expression. While the field is
selected, click the <em>All Unique</em> button to show all unique values
contained in that field. Here we want to select all Coal power plants,
so enter the expression as below and click <em>Select
Features</em>.</li>
</ol>
<pre><code>&quot;primary_fuel&quot; = &#39;Coal&#39;</code></pre>
<p><img src="images/qgis_expressions/operator4.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="5" style="list-style-type: decimal">
<li>In the main QGIS window, you will see the features matching the
expression selected in yellow color. We could select all Coal power
plants. What if we want to select all power plants that use renewable
energy source? We need to be able to specify multiple fuel types for the
query. Let’s update the expression. From the <em>Selection Toolbar</em>,
click the <em>Select Features by Expression…</em> again.</li>
</ol>
<p><img src="images/qgis_expressions/operator5.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="6" style="list-style-type: decimal">
<li>We can use the <strong>IN</strong> operator to specify a list of
fuel types that we want to select. Enter the following expression and
click <em>Select Features</em>.</li>
</ol>
<pre><code>&quot;primary_fuel&quot; IN (&#39;Biomass&#39;, &#39;Geothermal&#39;, &#39;Hydro&#39;, &#39;Solar&#39;, &#39;Wind&#39;, &#39;Storage&#39;, &#39;Wave and Tidal&#39;)</code></pre>
<p><img src="images/qgis_expressions/operator6.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="7" style="list-style-type: decimal">
<li>You will now see all power plants with renewable fuel types
selected. Click the <em>Deselect Features from All Layers</em>
button.</li>
</ol>
<p><img src="images/qgis_expressions/operator7.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="8" style="list-style-type: decimal">
<li>Next, we will learn how we can use expressions to extract certain
features into a new layer. Open Processing Toolbox from
<strong>Processing → Toolbox</strong>. Search and locate the algorithm
<strong>Vector selection → Extract by expression</strong> and
double-click to launch it.</li>
</ol>
<p><img src="images/qgis_expressions/operator8.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="expression-functions" class="section level2">
<h2>1.2 Expression Functions</h2>
</div>
</div>
<div id="advanced-expressions" class="section level1">
<h1>2. Advanced Expressions</h1>
<div id="geometry-generators" class="section level2">
<h2>2.1 Geometry Generators</h2>
</div>
<div id="iterations" class="section level2">
<h2>2.2 Iterations</h2>
</div>
</div>
<div id="data-credits" class="section level1">
<h1>Data Credits</h1>
<ul>
<li>Admin 1 – States, Provinces: Made with Natural Earth. Free vector
and raster map data @ naturalearthdata.com. Admin1 boundaries were
edited and combined with countries (India POV) boundaries.</li>
<li>Global Power Plant Database: Global Energy Observatory, Google, KTH
Royal Institute of Technology in Stockholm, Enipedia, World Resources
Institute. 2021. Global Power Plant Database version 1.3.0. Accessed
through <a
href="https://datasets.wri.org/datasets/global-power-plant-database"
class="uri">https://datasets.wri.org/datasets/global-power-plant-database</a>
on <date></li>
</ul>
</div>
<div id="license" class="section level1">
<h1>License</h1>
<p>This workshop material is licensed under a <a
href="https://creativecommons.org/licenses/by/4.0/">Creative Commons
Attribution 4.0 International (CC BY 4.0)</a>. You are free to re-use
and adapt the material but are required to give appropriate credit to
the original author as below:</p>
<p><em>QGIS Expressions Masterclass</em> by Ujaval Gandhi <a
href="https://spatialthoughts.com">www.spatialthoughts.com</a></p>
<hr />
</div>

<!-- Comment Section Powered by utterances -->
<div id="comments">
  <hr />
  <p>If you want to report any issues with this page, please comment below.</p>
<script src="https://utteranc.es/client.js"
        repo="spatialthoughts/courses"
        issue-term="title"
        label="comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
